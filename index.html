<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realtime Line Chart with Plotly and Firebase</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        h1{
            text-align: center;
            font-size: 48px;
            color: #ff6347;
            margin-top: 20px;

        }
    </style>
   </head>
<body>
    <h1>NZSK01</h1>
        <div id="chart_hcho_sensor" class="chart"></div>
        <div id="chart_light_sensor" class="chart"></div>
        <div id="chart_tvoc_sensor_co2" class="chart"></div>
        <div id="chart_tvoc_sensor_rh" class="chart"></div>
        <div id="chart_tvoc_sensor_temperature" class="chart"></div>
        <div id="chart_tvoc_sensor_tvoc" class="chart"></div>
        <div id="chart_tvoc_ppm_2_5" class="chart"></div>
        <div id="chart_tvoc_ppm_10" class="chart"></div>
        <div id="chart_sound_sensor" class="chart"></div>
    <script>

 const firebaseConfig = {
    apiKey: "AIzaSyDC1h57a0NiWMT9AXHwKCjj0nuxFvTpGQI",
    authDomain: "nzfl-testing-2.firebaseapp.com",
    databaseURL: "https://nzfl-testing-2-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "nzfl-testing-2",
    storageBucket: "nzfl-testing-2.appspot.com",
    messagingSenderId: "49651777220",
    appId: "1:49651777220:web:8f6827edbdf66cbf231391"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database().ref('device_01');

//////////////////////////////////////////////////////////////////
function fetchDataAndUpdatechart_hcho_sensor() {
    database.once('value')
        .then(snapshot => {
            const data = snapshot.val();
            const timestamps = [];
            const hcho_sensor_values = []; 

            for (let key in data) {
                const timestamp = new Date(parseInt(key) * 1000);
                timestamps.push(timestamp.toLocaleString('en-SG', { timeZone: 'Asia/Singapore' }));
                hcho_sensor_values.push(data[key].hcho_sensor);
            }
            var chart_hcho_sensor = document.getElementById('chart_hcho_sensor');
            Plotly.newPlot(chart_hcho_sensor, [{
                x: timestamps,
                y: hcho_sensor_values,
                type: 'scatter',
                mode: 'lines+markers',
                line: {
                    color: 'rgb(255, 0, 0)', 
                    width: 1 
                },
                name: 'chart_hcho_sensor'
            }], {
                title: {
                    text: 'HCHO Levels',
                    font: {size: 26, bold:true}
                }, 
                xaxis: {
                    tickfont: {
                        size:22.5 // Adjust the font size of the x-axis ticks
                    },
                
                },
                yaxis: {
                    
                    tickfont: {
                        size: 22.5 
                    },
                }
            });

        })
        .catch(error => {
            console.error("Error fetching data:", error);
        });
}
//////////////////////////////////////////////////////////////////
function fetchDataAndUpdatechart_light_sensor() {
    database.once('value')
        .then(snapshot => {
            const data = snapshot.val();
            const timestamps = [];
            const light_sensor_values = []; 

            for (let key in data) {
                timestamps.push(new Date(parseInt(key) * 1000).toLocaleString('en-SG', { timeZone: 'Asia/Singapore' }));
                light_sensor_values.push(data[key].light_sensor);
            }

            // Update the chart with new data
            var chart_light_sensor = document.getElementById('chart_light_sensor');
            Plotly.newPlot(chart_light_sensor, [{
                x: timestamps,
                y: light_sensor_values,
                type: 'scatter',
                mode: 'lines+markers',
                line: {
                    color: 'rgb(236, 240, 10)', 
                    width: 1 
    },
                name: 'chart_light_sensor'
            }], {
                title: {
        text: 'LIGHT SENSOR Levels',
        font: {size: 26, bold:true}
                }, 
                xaxis: {
                    tickfont: {
                        size:22.5 // Adjust the font size of the x-axis ticks
                    },
                
                },
                yaxis: {
                    
                    tickfont: {
                        size: 22.5 
                    },
                }
            });

        })
        .catch(error => {
            console.error("Error fetching data:", error);
        });
}
//////////////////////////////////////////////////////////////////
function fetchDataAndUpdatechart_tvoc_sensor_co2() {
    database.once('value')
        .then(snapshot => {
            const data = snapshot.val();
            const timestamps = [];
            const tvoc_sensor_co2_values = []; 

            for (let key in data) {
                timestamps.push(new Date(parseInt(key) * 1000).toLocaleString('en-SG', { timeZone: 'Asia/Singapore' }));
                tvoc_sensor_co2_values.push(data[key].tvoc_sensor_co2);
            }
            console.log(timestamps);
            // Update the chart with new data
            var chart_tvoc_sensor_co2 = document.getElementById('chart_tvoc_sensor_co2');
            Plotly.newPlot(chart_tvoc_sensor_co2, [{
                x: timestamps,
                y: tvoc_sensor_co2_values,
                type: 'scatter',
                mode: 'lines+markers',
                line: {
                    color: 'rgb(50, 168, 82)', 
                    width: 1 },

                name: 'chart_tvoc_sensor_co2'
            }], {
                title: {
        text: 'CO2 Levels',
        font: {size: 26, bold:true}
                }, 
                xaxis: {
                    tickfont: {
                        size:22.5 // Adjust the font size of the x-axis ticks
                    },
                
                },
                yaxis: {
                    
                    tickfont: {
                        size: 22.5 
                    },
                }
            });

        })
        .catch(error => {
            console.error("Error fetching data:", error);
        });
}
//////////////////////////////////////////////////////////////////
function fetchDataAndUpdatechart_tvoc_sensor_rh() {
    database.once('value')
        .then(snapshot => {
            const data = snapshot.val();
            const timestamps = [];
            const tvoc_sensor_rh_values = []; 

            for (let key in data) {
                timestamps.push(new Date(parseInt(key) * 1000).toLocaleString('en-SG', { timeZone: 'Asia/Singapore' }));
                tvoc_sensor_rh_values.push(data[key].tvoc_sensor_rh);
            }

            // Update the chart with new data
            var chart_tvoc_sensor_rh = document.getElementById('chart_tvoc_sensor_rh');
            Plotly.newPlot(chart_tvoc_sensor_rh, [{
                x: timestamps,
                y: tvoc_sensor_rh_values,
                type: 'scatter',
                mode: 'lines+markers',
                line: {
                    color: 'rgb(240, 129, 10)', 
                    width: 1 },

                name: 'chart_tvoc_sensor_rh'
            }], {
                title: {
        text: 'RH Levels',
        font: {size: 26, bold:true}
                }, 
                xaxis: {
                    tickfont: {
                        size:22.5 // Adjust the font size of the x-axis ticks
                    },
                
                },
                yaxis: {
                    
                    tickfont: {
                        size: 22.5 
                    },
                }
            });

        })
        .catch(error => {
            console.error("Error fetching data:", error);
        });
}
//////////////////////////////////////////////////////////////////
function fetchDataAndUpdatechart_tvoc_sensor_temperature() {
    database.once('value')
        .then(snapshot => {
            const data = snapshot.val();
            const timestamps = [];
            const tvoc_sensor_temperature_values = []; 

            for (let key in data) {
                timestamps.push(new Date(parseInt(key) * 1000).toLocaleString('en-SG', { timeZone: 'Asia/Singapore' }));
                tvoc_sensor_temperature_values.push(data[key].tvoc_sensor_temperature);
            }

            // Update the chart with new data
            var chart_tvoc_sensor_temperature = document.getElementById('chart_tvoc_sensor_temperature');
            Plotly.newPlot(chart_tvoc_sensor_temperature, [{
                x: timestamps,
                y: tvoc_sensor_temperature_values,
                type: 'scatter',
                mode: 'lines+markers',
                line: {
                    color: 'rgb(10, 240, 240)', 
                    width: 1 },

                name: 'chart_tvoc_sensor_temperature'
            }], {
                title: {
        text: 'TEMPERATURE Levels',
        font: {size: 26, bold:true}
                }, 
                xaxis: {
                    tickfont: {
                        size:22.5 // Adjust the font size of the x-axis ticks
                    },
                
                },
                yaxis: {
                    
                    tickfont: {
                        size: 22.5 
                    },
                }
            });

        })
        .catch(error => {
            console.error("Error fetching data:", error);
        });
}
//////////////////////////////////////////////////////////////////
function fetchDataAndUpdatechart_tvoc_sensor_tvoc() {
    database.once('value')
        .then(snapshot => {
            const data = snapshot.val();
            const timestamps = [];
            const tvoc_sensor_tvoc_values = []; 

            for (let key in data) {
                timestamps.push(new Date(parseInt(key) * 1000).toLocaleString('en-SG', { timeZone: 'Asia/Singapore' }));
                tvoc_sensor_tvoc_values.push(data[key].tvoc_sensor_tvoc);
            }

            // Update the chart with new data
            var chart_tvoc_sensor_tvoc = document.getElementById('chart_tvoc_sensor_tvoc');
            Plotly.newPlot(chart_tvoc_sensor_tvoc, [{
                x: timestamps,
                y: tvoc_sensor_tvoc_values,
                type: 'scatter',
                mode: 'lines+markers',
                line: {
                    color: 'rgb(202, 10, 240)', 
                    width: 1 },

                name: 'chart_tvoc_sensor_tvoc'
            }], {
                title: {
        text: 'TVOC Levels',
        font: {size: 26, bold:true}
                }, 
                xaxis: {
                    tickfont: {
                        size:22.5 // Adjust the font size of the x-axis ticks
                    },
                
                },
                yaxis: {
                    
                    tickfont: {
                        size: 22.5 
                    },
                }
            });

        })
        .catch(error => {
            console.error("Error fetching data:", error);
        });
}
/////////////////////////////////////////////////////////////////
function fetchDataAndUpdatechart_tvoc_ppm_2_5() {
    
    database.once('value')
        .then(snapshot => {
            const data = snapshot.val();
            const timestamps = [];
            const tvoc_ppm_2_5_values = []; 

            for (let key in data) {
                const tvoc = data[key].tvoc_ppm_2_5;
                // Check if tvoc value is present
                if (tvoc !== undefined && tvoc !== null) {
                    timestamps.push(new Date(parseInt(key) * 1000).toLocaleString('en-SG', { timeZone: 'Asia/Singapore' }));
                    tvoc_ppm_2_5_values.push(tvoc);
                }
            }
            // Update the chart with new data
            var chart_tvoc_ppm_2_5 = document.getElementById('chart_tvoc_ppm_2_5');
            Plotly.newPlot(chart_tvoc_ppm_2_5, [{
                x: timestamps,
                y: tvoc_ppm_2_5_values,
                type: 'scatter',
                mode: 'lines+markers',
                line: {
                    color: 'rgb(245, 7, 119)', 
                    width: 1 },

                name: 'chart_tvoc_ppm_2_5'
            }], {
                title: {
        text: 'tvoc_ppm_2_5',
        font: {size: 26, bold:true}
                }, 
                xaxis: {
                    tickfont: {
                        size:22.5 // Adjust the font size of the x-axis ticks
                    },
                
                },
                yaxis: {
                    
                    tickfont: {
                        size: 22.5 
                    },
                }
            });

        })
        .catch(error => {
            console.error("Error fetching data:", error);
        });
}
/////////////////////////////////////////////////////////////////
function fetchDataAndUpdatechart_tvoc_ppm_10() {
    
    database.once('value')
        .then(snapshot => {
            const data = snapshot.val();
            const timestamps = [];
            const tvoc_ppm_10_values = []; 

            for (let key in data) {
                const tvoc10 = data[key].tvoc_ppm_10;
                // Check if tvoc value is present
                if (tvoc10 !== undefined && tvoc10 !== null) {
                    timestamps.push(new Date(parseInt(key) * 1000).toLocaleString('en-SG', { timeZone: 'Asia/Singapore' }));
                    tvoc_ppm_10_values.push(tvoc10);
                }
            }
            // Update the chart with new data
            var chart_tvoc_ppm_10 = document.getElementById('chart_tvoc_ppm_10');
            Plotly.newPlot(chart_tvoc_ppm_10, [{
                x: timestamps,
                y: tvoc_ppm_10_values,
                type: 'scatter',
                mode: 'lines+markers',
                line: {
                    color: 'rgb(92, 2, 44)', 
                    width: 1 },

                name: 'chart_tvoc_ppm_10'
            }], {
                title: {
        text: 'tvoc_ppm_10',
        font: {size: 26, bold:true}
                }, 
                xaxis: {
                    tickfont: {
                        size:22.5 // Adjust the font size of the x-axis ticks
                    },
                
                },
                yaxis: {
                    
                    tickfont: {
                        size: 22.5 
                    },
                }
            });

        })
        .catch(error => {
            console.error("Error fetching data:", error);
        });
}
//////////////////////////////////
function fetchDataAndUpdatechart_sound_sensor() {
    
    database.once('value')
        .then(snapshot => {
            const data = snapshot.val();
            const timestamps = [];
            const sound_sensor_values = []; 

            for (let key in data) {
                const sensor = data[key].sound_sensor;
                if (sensor !== undefined && sensor !== null) {
                    timestamps.push(new Date(parseInt(key) * 1000).toLocaleString('en-SG', { timeZone: 'Asia/Singapore' }));
                    sound_sensor_values.push(sensor);
                }
            }
            // Update the chart with new data
            var chart_sound_sensor = document.getElementById('chart_sound_sensor');
            Plotly.newPlot(chart_sound_sensor, [{
                x: timestamps,
                y: sound_sensor_values,
                type: 'scatter',
                mode: 'lines+markers',
                line: {
                    color: 'rgb(1, 62, 179)', 
                    width: 1 },

                name: 'sound_sensor'
            }], {
                title: {
        text: 'sound_sensor',
        font: {size: 26, bold:true}
                }, 
                xaxis: {
                    tickfont: {
                        size:22.5 // Adjust the font size of the x-axis ticks
                    },
                
                },
                yaxis: {
                    
                    tickfont: {
                        size: 22.5 
                    },
                }
            });

        })
        .catch(error => {
            console.error("Error fetching data:", error);
        });
}
fetchDataAndUpdatechart_hcho_sensor();
fetchDataAndUpdatechart_light_sensor();
fetchDataAndUpdatechart_tvoc_sensor_co2();
fetchDataAndUpdatechart_tvoc_sensor_rh();
fetchDataAndUpdatechart_tvoc_sensor_temperature();
fetchDataAndUpdatechart_tvoc_sensor_tvoc();
fetchDataAndUpdatechart_tvoc_ppm_2_5();
fetchDataAndUpdatechart_tvoc_ppm_10();
fetchDataAndUpdatechart_sound_sensor();
    </script>

</body>

</html>

